
#include "sys/alt_stdio.h"
#include "system.h"
#include "altera_avalon_pio_regs.h"
#include "stdint.h"

int main()
{ 
  alt_putstr("Hello from Nios II!\n");
  uint8_t on_off = 1;

  /* Event loop never exits. */
  while (1){

	  IOWR(LED_BASE, 0, on_off);
	  on_off = ~on_off;
	  alt_busy_sleep(1000000);
	  IOWR_32DIRECT(EPCQ_AVL_CSR_BASE, 0x03, 0x00000002);
	  //IOWR_8DIRECT(EPCQ_AVL_CSR_BASE, 0x000000, 0x06);
	  //IOWR_8DIRECT(EPCQ_AVL_CSR_BASE, 0x000000, 0x9F);
	  //uint8_t data = IORD_8DIRECT(EPCQ_AVL_CSR_BASE, 0x000000);
		/*
			IOWR_8DIRECT(EPCQ_AVL_MEM_BASE, 0x000000 + 0, 0x64); // d
			IOWR_8DIRECT(EPCQ_AVL_MEM_BASE, 0x000000 + 1, 0x65); // e
			IOWR_8DIRECT(EPCQ_AVL_MEM_BASE, 0x000000 + 2, 0x6E); // n
			IOWR_8DIRECT(EPCQ_AVL_MEM_BASE, 0x000000 + 3, 0x6E); // n
			IOWR_8DIRECT(EPCQ_AVL_MEM_BASE, 0x000000 + 4, 0x69); // i
			IOWR_8DIRECT(EPCQ_AVL_MEM_BASE, 0x000000 + 5, 0x73); // s
		*/
	  for (int i = 0; i < 20000; i++) {
		uint8_t data = IORD_8DIRECT(EPCQ_AVL_MEM_BASE, 0x000000 + i);
		printf("%02X ", data);
		//IOWR_8DIRECT(EPCQ_AVL_MEM_BASE, 0x000000 + i, data+1);
		if ((i+1)%16==0) printf("\n");
	}
  };

  return 0;
}
